{"version":3,"sources":["../node_modules/peerjs/dist sync","App.js","reportWebVitals.js","index.js"],"names":["webpackEmptyContext","req","e","Error","code","keys","resolve","module","exports","id","capitalizeTheFirstLetterOfEachWord","words","separateWord","toLowerCase","split","i","length","charAt","toUpperCase","substring","join","NameInput","props","React","useState","name","setName","errors","setErrors","useEffect","document","getElementById","focus","onSubmit","preventDefault","match","onValid","className","for","type","value","onChange","target","FilmForm","platforms","setPlatforms","placeholder","multiple","v","selectedOptions","map","o","onClick","Object","onAjouter","SalonForm","setJoin","loading","setLoading","role","values","onRejoindre","trim","catch","onCreer","Content","salon","setSalon","films","setFilms","autres","setAutres","winner","setWinner","peerRef","useRef","nameRef","current","filmsRef","autresRef","syncToOne","autre","connections","send","syncToAll","except","showWinner","ready","created","disabled","autresArr","all","reduce","acc","r","f","push","Math","floor","random","destroy","scope","copy","slice","splice","assign","index","supprimer","film","entries","result","characters","charactersLength","genCode","peer","Peer","debug","on","conn","connName","data","console","log","Promise","reject","err","connect","App","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","ReactDOM","render","StrictMode"],"mappings":"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","file":"static/js/main.8ad33506.chunk.js","sourcesContent":["function webpackEmptyContext(req) {\n\tvar e = new Error(\"Cannot find module '\" + req + \"'\");\n\te.code = 'MODULE_NOT_FOUND';\n\tthrow e;\n}\nwebpackEmptyContext.keys = function() { return []; };\nwebpackEmptyContext.resolve = webpackEmptyContext;\nmodule.exports = webpackEmptyContext;\nwebpackEmptyContext.id = 18;","import React from 'react'\r\nimport Peer from 'peerjs'\r\n\r\nfunction genCode(length=5) {\r\n\tvar result           = '';\r\n\tvar characters       = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ';\r\n\tvar charactersLength = characters.length;\r\n\tfor ( var i = 0; i < length; i++ ) {\r\n\t\tresult += characters.charAt(Math.floor(Math.random() * \r\n\t\tcharactersLength));\r\n\t}\r\n\treturn result;\r\n}\r\n\r\nfunction capitalizeTheFirstLetterOfEachWord(words) {\r\n\tvar separateWord = words.toLowerCase().split(' ');\r\n\tfor (var i = 0; i < separateWord.length; i++) {\r\n\t\tseparateWord[i] = separateWord[i].charAt(0).toUpperCase() +\r\n\t\tseparateWord[i].substring(1);\r\n\t}\r\n\treturn separateWord.join(' ');\r\n}\r\n\r\nconst NameInput = props => {\r\n\tconst [name, setName] = React.useState('');\r\n\tconst [errors, setErrors] = React.useState({});\r\n\r\n\tconst onChange = e => {\r\n\t\tsetName(e.target.value);\r\n\t}\r\n\r\n\tconst onSubmit = e => {\r\n\t\te.preventDefault();\r\n\r\n\t\tif(name.match(/^[A-zÀ-ú]+$/))\r\n\t\t\tprops.onValid(name);\r\n\t\telse\r\n\t\t\tsetErrors({name: 'Il faut choisir un nom avec des lettres.'});\r\n\t};\r\n\r\n\tReact.useEffect(() => {\r\n\t\tdocument.getElementById('name').focus();\r\n\t}, []);\r\n\r\n\treturn <form onSubmit={onSubmit}>\r\n\t\t<div className=\"mb-3\">\r\n\t\t\t<label for=\"name\" className=\"form-label\">T'es qui ?</label>\r\n\t\t\t<div className=\"input-group has-validation\">\r\n\t\t\t\t<input type=\"text\" className={\"form-control\"+(errors.name ? ' is-invalid':'')} value={name} onChange={onChange} id=\"name\"/>\r\n\t\t\t\t{errors.name && <div id=\"validationServerUsernameFeedback\" className=\"invalid-feedback\">\r\n\t\t\t\t\t{errors.name}\r\n\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<button type=\"submit\" className=\"btn btn-primary\">Valider</button>\r\n\t</form>\r\n}\r\n\r\nconst FilmForm = props => {\r\n\tconst [name, setName] = React.useState('');\r\n\tconst [platforms, setPlatforms] = React.useState([]);\r\n\tconst [errors, setErrors] = React.useState({});\r\n\r\n\tconst onChangeName = e => {\r\n\t\tsetName(e.target.value);\r\n\t}\r\n\r\n\tconst onChangePlatforms = e => {\r\n\t\tlet v = [...e.target.selectedOptions].map(o => o.value);\r\n\t\tsetPlatforms(v);\r\n\t}\r\n\r\n\tconst onSubmit = e => {\r\n\t\te.preventDefault();\r\n\r\n\t\tlet errors = {};\r\n\t\tif(name.length === 0)\r\n\t\t\terrors.name = \"Faut choisir le nom d'un film !\";\r\n\t\tif(platforms.length === 0)\r\n\t\t\terrors.platforms = \"Faut choisir au moins une plateforme !\";\r\n\r\n\t\tsetErrors(errors);\r\n\r\n\t\tif(Object.keys(errors).length === 0) {\r\n\t\t\tprops.onAjouter({name: capitalizeTheFirstLetterOfEachWord(name), platforms});\r\n\t\t\tsetName('');\r\n\t\t\tsetPlatforms([]);\r\n\t\t}\r\n\t};\r\n\r\n\treturn <tr>\r\n\t\t<td>\r\n\t\t\t<div className=\"input-group has-validation\">\r\n\t\t\t\t<input type=\"text\" className={\"form-control\"+(errors.name ? ' is-invalid':'')} value={name} onChange={onChangeName} id=\"name\" placeholder=\"Nom du film\"/>\r\n\t\t\t\t{errors.name && <div id=\"validationServerUsernameFeedback\" className=\"invalid-feedback\">\r\n\t\t\t\t\t{errors.name}\r\n\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t</td>\r\n\t\t<td>\r\n\t\t\t<div className=\"input-group has-validation\">\r\n\t\t\t\t<select multiple value={platforms} onChange={onChangePlatforms} className={\"form-select\"+(errors.platforms ? ' is-invalid':'')}>\r\n\t\t\t\t\t<option>Netflix</option>\r\n\t\t\t\t\t<option>Amazon</option>\r\n\t\t\t\t\t<option>Disney</option>\r\n\t\t\t\t\t<option>OCS</option>\r\n\t\t\t\t\t<option>Salto</option>\r\n\t\t\t\t\t<option>Canal+</option>\r\n\t\t\t\t\t<option>Apple TV</option>\r\n\t\t\t\t</select>\r\n\t\t\t\t{errors.platforms && <div id=\"validationServerUsernameFeedback\" className=\"invalid-feedback\">\r\n\t\t\t\t\t{errors.platforms}\r\n\t\t\t\t</div>}\r\n\t\t\t</div>\r\n\t\t</td>\r\n\t\t<td><button type=\"button\" className=\"btn btn-primary\" onClick={onSubmit}><i className=\"bi bi-plus-circle-fill\"></i></button></td>\r\n\t</tr>\r\n}\r\n\r\nconst SalonForm = props => {\r\n\tconst [join, setJoin] = React.useState(false);\r\n\tconst [name, setName] = React.useState('');\r\n\tconst [errors, setErrors] = React.useState({});\r\n\tconst [loading, setLoading] = React.useState(false);\r\n\r\n\tif(join) {\r\n\t\tconst onChangeName = e => {\r\n\t\t\tsetName(e.target.value);\r\n\t\t}\r\n\r\n\t\tconst onSubmit = e => {\r\n\t\t\te.preventDefault();\r\n\r\n\t\t\tlet errors = {};\r\n\t\t\tif(name.length === 0)\r\n\t\t\t\terrors.name = \"Il faut indiquer le code du salon !\";\r\n\r\n\t\t\tsetErrors(errors);\r\n\r\n\t\t\tif(Object.values(errors).length === 0) {\r\n\t\t\t\tsetLoading(true);\r\n\t\t\t\tprops.onRejoindre(name.trim().toUpperCase())\r\n\t\t\t\t\t// .then(() => {\r\n\t\t\t\t\t// \t// console.log('!')\r\n\t\t\t\t\t// \tsetLoading(false);\r\n\t\t\t\t\t// \tsetName('');\r\n\t\t\t\t\t// \tsetJoin(false);\r\n\t\t\t\t\t// })\r\n\t\t\t\t\t.catch(e => {\r\n\t\t\t\t\t\t// console.log(e)\r\n\t\t\t\t\t\tsetLoading(false);\r\n\t\t\t\t\t\tsetErrors({name: 'Impossible de rejoindre ce salon'});\r\n\t\t\t\t\t})\r\n\t\t\t\t\t;\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t\tif(loading) {\r\n\t\t\treturn <div className=\"spinner-border\" role=\"status\">\r\n\t\t\t\t<span className=\"visually-hidden\">Loading...</span>\r\n\t\t\t</div>\r\n\t\t}\r\n\r\n\t\treturn <form onSubmit={onSubmit}>\r\n\t\t\t<div className=\"mb-3\">\r\n\t\t\t\t<div className=\"input-group has-validation\">\r\n\t\t\t\t\t<input type=\"text\" className={\"form-control\"+(errors.name ? ' is-invalid':'')} value={name} onChange={onChangeName} id=\"name\" placeholder=\"Code du salon\"/>\r\n\t\t\t\t\t{errors.name && <div id=\"validationServerUsernameFeedback\" className=\"invalid-feedback\">\r\n\t\t\t\t\t\t{errors.name}\r\n\t\t\t\t\t</div>}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t\t<button type=\"submit\" className=\"btn btn-primary\">Rejoindre</button>\r\n\t\t</form>\r\n\t}\r\n\r\n\treturn <>\r\n\t\t<p>Créer ou rejoindre un salon ?</p>\r\n\t\t<div className=\"buttons\">\r\n\t\t\t<button className=\"btn btn-primary\" type=\"button\" onClick={props.onCreer}>créer</button>\r\n\t\t\t<button className=\"btn btn-secondary\" type=\"button\" onClick={() => setJoin(true)}>rejoindre</button>\r\n\t\t</div>\r\n\t</>\r\n}\r\n\r\nconst Content = props => {\r\n\tconst [name, setName] = React.useState(null);\r\n\t// const [name, setName] = React.useState('bob');\r\n\tconst [salon, setSalon] = React.useState(null);\r\n\tconst [films, setFilms] = React.useState([]);\r\n\t// const [films, setFilms] = React.useState([{name: 'b', platforms: ['Netflix']}]);\r\n\tconst [autres, setAutres] = React.useState({});\r\n\t// const [autres, setAutres] = React.useState({Michel: [{name: 'a', platforms: ['Netflix']}]});\r\n\r\n\tconst [winner, setWinner] = React.useState(null);\r\n\r\n\tconst peerRef = React.useRef();\r\n\t// const connsRef = React.useRef({});\r\n\t// const connRef = React.useRef(null);\r\n\t// const autresRef = React.useRef({});\r\n\r\n\t// const setAutres = v => {\r\n\t// \tautresRef.current = v;\r\n\t// \t_setAutres(v);\r\n\t// };\r\n\r\n\tconst nameRef = React.useRef();\r\n\tnameRef.current = name;\r\n\tconst filmsRef = React.useRef();\r\n\tfilmsRef.current = films;\r\n\tconst autresRef = React.useRef();\r\n\tautresRef.current = autres;\r\n\r\n\t// return <>\r\n\t// \t<div id=\"webkit-keyframes-animation\">Je me réduis</div>\r\n\t// </>\r\n\r\n\t// React.useEffect(() => {\r\n\t// \tsetWinner({\r\n\t// \t\tname: 'Blabla',\r\n\t// \t\tplatforms: ['Netflix', 'Amazon']\r\n\t// \t});\r\n\t// }, []);\r\n\r\n\tif(winner) {\r\n\t\treturn <>\r\n\t\t\t<div className=\"countdown\">\r\n\t\t\t\t<div className=\"num5\">5</div>\r\n\t\t\t\t<div className=\"num4\">4</div>\r\n\t\t\t\t<div className=\"num3\">3</div>\r\n\t\t\t\t<div className=\"num2\">2</div>\r\n\t\t\t\t<div className=\"num1\">1</div>\r\n\t\t\t\t<div className=\"num0\">\r\n\t\t\t\t\t<h1>{winner.name}</h1>\r\n\t\t\t\t\t{winner.platforms.join(', ')}\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t</>\r\n\t}\r\n\r\n\tif(name === null) {\r\n\t\treturn <NameInput onValid={name => {\r\n\t\t\tsetName(name);\r\n\t\t}}/>\r\n\t}\r\n\r\n\tconst syncToOne = (autres, autre) => {\r\n\t\t// let conn = connsRef.current[autre];\r\n\t\t// console.log(peerRef.current.connections)\r\n\t\t// console.log(Object.keys(peerRef.current.connections))\r\n\t\t// console.log(autre)\r\n\t\t// console.log(peerRef.current.connections['tirage-membre-'+autre])\r\n\t\tlet conn = peerRef.current.connections[autre][0];\r\n\t\tconn.send({\r\n\t\t\ttype: 'sync',\r\n\t\t\tautres: autres,\r\n\t\t});\r\n\t};\r\n\r\n\tconst syncToAll = (autres, except=null) => {\r\n\t\t// for(let autre in connsRef.current) {\r\n\t\t\t// if(autre === except)\r\n\t\tfor(let autre in peerRef.current.connections) {\r\n\t\t\tif(autre === 'tirage-membre-'+except)\r\n\t\t\t\tcontinue;\r\n\t\t\tsyncToOne(autres, autre);\r\n\t\t}\r\n\t};\r\n\r\n\tconst showWinner = winner => {\r\n\t\t// console.log(winner)\r\n\t\tsetWinner(winner);\r\n\t\t// TODO\r\n\t};\r\n\r\n\tconst onCreerSalon = () => {\r\n\t\tlet code = genCode();\r\n\r\n\t\tconst peer = new Peer('tirage-salon-'+code, {\r\n\t\t\tdebug: 3\r\n\t\t});\r\n\t\tpeerRef.current = peer;\r\n\t\tpeer.on('connection', (conn) => {\r\n\t\t\tlet connName;\r\n\r\n\t\t\tconn.on('data', (data) => {\r\n\t\t\t\tconsole.log('DATA!')\r\n\t\t\t\tconsole.log(data)\r\n\t\t\t\tif(data.type === 'hello') {\r\n\t\t\t\t\tconnName = data.name;\r\n\t\t\t\t\t// connsRef.current[data.name] = conn;\r\n\r\n\t\t\t\t\tsyncToOne(Object.assign({}, autresRef.current, {[nameRef.current]: filmsRef.current}), 'tirage-membre-'+connName);\r\n\r\n\t\t\t\t\tlet copy = Object.assign({}, autresRef.current, {[connName]: []});\r\n\t\t\t\t\tsetAutres(copy);\r\n\t\t\t\t}\r\n\t\t\t\telse if(data.type === 'add') {\r\n\t\t\t\t\t// console.log(autresRef.current)\r\n\t\t\t\t\tlet copy = Object.assign({}, autresRef.current);\r\n\t\t\t\t\tcopy[connName] = copy[connName].slice();\r\n\t\t\t\t\tcopy[connName].push(data.film);\r\n\r\n\t\t\t\t\tsyncToAll(Object.assign({}, copy, {[nameRef.current]: filmsRef.current}), connName);\r\n\r\n\t\t\t\t\tsetAutres(copy);\r\n\t\t\t\t}\r\n\t\t\t\telse if(data.type === 'remove') {\r\n\t\t\t\t\tlet copy = Object.assign({}, autresRef.current);\r\n\t\t\t\t\tcopy[connName] = copy[connName].slice();\r\n\t\t\t\t\tcopy[connName].splice(data.index, 1);\r\n\r\n\t\t\t\t\tsyncToAll(Object.assign({}, copy, {[nameRef.current]: filmsRef.current}), connName);\r\n\r\n\t\t\t\t\tsetAutres(copy);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t\tconn.on('close', () => {\r\n\t\t\t\tconsole.log('CLOSE: '+connName)\r\n\t\t\t\tlet copy = Object.assign({}, autresRef.current);\r\n\t\t\t\tdelete copy[connName];\r\n\r\n\t\t\t\tsyncToAll(Object.assign({}, copy, {[nameRef.current]: filmsRef.current}), connName);\r\n\r\n\t\t\t\tsetAutres(copy);\r\n\t\t\t});\r\n\t\t\t// conn.on('open', () => {\r\n\t\t\t// \tconsole.log('salon:open')\r\n\t\t\t// \tconn.send('hello!');\r\n\t\t\t// });\r\n\t\t});\r\n\r\n\t\tsetSalon({code, created: true});\r\n\t};\r\n\r\n\tconst onRejoindreSalon = code => {\r\n\t\treturn new Promise((resolve, reject) => {\r\n\t\t\tconst peer = new Peer('tirage-membre-'+name, {\r\n\t\t\t\tdebug: 3\r\n\t\t\t});\r\n\t\t\tpeerRef.current = peer;\r\n\t\t\tpeer.on('error', err => {\r\n\t\t\t\tconsole.log('ERROR')\r\n\t\t\t\tconsole.log(err)\r\n\t\t\t\treject(err);\r\n\t\t\t});\r\n\t\t\tpeer.on('open', () => {\r\n\t\t\t\tconst conn = peer.connect('tirage-salon-'+code, {\r\n\t\t\t\t\t// reliable: true\r\n\t\t\t\t});\r\n\t\t\t\t// connRef.current = conn;\r\n\t\t\t\tconn.on('open', () => {\r\n\t\t\t\t\t// console.log('open')\r\n\t\t\t\t\tconn.send({\r\n\t\t\t\t\t\ttype: 'hello',\r\n\t\t\t\t\t\tname,\r\n\t\t\t\t\t});\r\n\t\t\t\t\tsetSalon({code, created: false});\r\n\t\t\t\t\tsetFilms([]);\r\n\t\t\t\t\tsetAutres({});\r\n\t\t\t\t\tresolve();\r\n\t\t\t\t});\r\n\t\t\t\tconn.on('data', data => {\r\n\t\t\t\t\tconsole.log('DATA!')\r\n\t\t\t\t\tconsole.log(data)\r\n\t\t\t\t\tif(data.type === 'sync') {\r\n\t\t\t\t\t\tdelete data.autres[name];\r\n\t\t\t\t\t\tsetAutres(data.autres);\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse if(data.type === 'winner') {\r\n\t\t\t\t\t\tshowWinner(data.winner);\r\n\t\t\t\t\t}\r\n\t\t\t\t});\r\n\t\t\t\tconn.on('error', err => {\r\n\t\t\t\t\tconsole.log('ERROR')\r\n\t\t\t\t\tconsole.log(err)\r\n\t\t\t\t\treject(err);\r\n\t\t\t\t});\r\n\t\t\t\tconn.on('close', () => {\r\n\t\t\t\t\tsetSalon(null);\r\n\t\t\t\t});\r\n\t\t\t});\r\n\t\t});\r\n\t};\r\n\r\n\tconst supprimer = i => {\r\n\t\tlet copy = films.slice();\r\n\t\tcopy.splice(i, 1);\r\n\t\tsetFilms(copy);\r\n\r\n\t\tif(salon.created)\r\n\t\t\tsyncToAll(Object.assign({}, autresRef.current, {[name]: copy}));\r\n\t\telse {\r\n\t\t\t// connRef.current.send({\r\n\t\t\tObject.values(peerRef.current.connections)[0][0].send({\r\n\t\t\t\ttype: 'remove',\r\n\t\t\t\tindex: i,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\tconst ajouter = film => {\r\n\t\tlet copy = films.slice();\r\n\t\tcopy.push(film);\r\n\t\tsetFilms(copy);\r\n\r\n\t\tif(salon.created)\r\n\t\t\tsyncToAll(Object.assign({}, autresRef.current, {[name]: copy}));\r\n\t\telse {\r\n\t\t\t// connRef.current.send({\r\n\t\t\t// console.log(peerRef.current.connections)\r\n\t\t\tObject.values(peerRef.current.connections)[0][0].send({\r\n\t\t\t\ttype: 'add',\r\n\t\t\t\tfilm,\r\n\t\t\t});\r\n\t\t}\r\n\t};\r\n\r\n\tconst onQuitterSalon = () => {\r\n\t\tpeerRef.current.destroy();\r\n\t\tsetSalon(null);\r\n\t\tsetFilms([]);\r\n\t\tsetAutres({});\r\n\t};\r\n\r\n\tconst onTirageAuSort = () => {\r\n\t\tlet autresArr = Object.values(autresRef.current)\r\n\t\tlet all = \r\n\t\t\tautresArr.length > 0 ?\r\n\t\t\t\tautresArr.reduce((acc, v) => {\r\n\t\t\t\t\tlet r = acc ?? [];\r\n\t\t\t\t\tfor(let f of v)\r\n\t\t\t\t\t\tr.push(f); \r\n\t\t\t\t\treturn r;\r\n\t\t\t\t})\r\n\t\t\t\t:\r\n\t\t\t\t[]\r\n\t\t;\r\n\t\tfor(let f of films)\r\n\t\t\tall.push(f);\r\n\t\t// console.log(all);\r\n\r\n\t\tlet winner = all[Math.floor(Math.random() * all.length)];\r\n\t\t// console.log(winner)\r\n\r\n\t\t// for(let autre in connsRef.current) {\r\n\t\t// \tlet conn = connsRef.current[autre];\r\n\t\tfor(let autre in peerRef.current.connections) {\r\n\t\t\tlet conn = peerRef.current.connections[autre][0];\r\n\t\t\tconn.send({\r\n\t\t\t\ttype: 'winner',\r\n\t\t\t\twinner,\r\n\t\t\t});\r\n\t\t}\r\n\r\n\t\tshowWinner(winner);\r\n\t};\r\n\r\n\tlet ready = salon?.created && films.length === 3;\r\n\tif(ready) {\r\n\t\tfor(let autre of Object.values(autres)) {\r\n\t\t\tif(autre.length < 3) {\r\n\t\t\t\tready = false;\r\n\t\t\t\tbreak;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\treturn <>\r\n\t\t<h1>Salut {name} !</h1>\r\n\t\t<hr/>\r\n\t\t{\r\n\t\t\t!salon ?\r\n\t\t\t\t<SalonForm onCreer={onCreerSalon} onRejoindre={onRejoindreSalon}/>\r\n\t\t\t\t:\r\n\t\t\t\t<>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<p>Tu as {salon.created ? 'créé':'rejoint'} le salon : {salon.code}</p>\r\n\t\t\t\t\t\t<div className=\"buttons\">\r\n\t\t\t\t\t\t\t{salon.created && <button disabled={!ready} type=\"submit\" className=\"btn btn-success\" onClick={onTirageAuSort}>Tirer au sort</button>}\r\n\t\t\t\t\t\t\t<button type=\"submit\" className=\"btn btn-danger\" onClick={onQuitterSalon}>Quitter</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<hr/>\r\n\t\t\t\t\t<div>\r\n\t\t\t\t\t\t<h2>Mes films</h2>\r\n\t\t\t\t\t\t<table className=\"table\">\r\n\t\t\t\t\t\t\t<thead>\r\n\t\t\t\t\t\t\t\t<tr>\r\n\t\t\t\t\t\t\t\t\t<th scope=\"col\">Nom</th>\r\n\t\t\t\t\t\t\t\t\t<th scope=\"col\">Plateformes</th>\r\n\t\t\t\t\t\t\t\t\t<th scope=\"col\"></th>\r\n\t\t\t\t\t\t\t\t</tr>\r\n\t\t\t\t\t\t\t</thead>\r\n\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t{films.map((f, i) => (<tr key={f.name}>\r\n\t\t\t\t\t\t\t\t\t<td>{f.name}</td>\r\n\t\t\t\t\t\t\t\t\t<td>{f.platforms.join(', ')}</td>\r\n\t\t\t\t\t\t\t\t\t<td><button type=\"button\" className=\"btn btn-danger\" onClick={() => supprimer(i)}><i className=\"bi bi-trash-fill\"></i></button></td>\r\n\t\t\t\t\t\t\t\t</tr>))}\r\n\t\t\t\t\t\t\t\t{films.length < 3 && <FilmForm onAjouter={ajouter}/>}\r\n\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{Object.values(autres).length > 0 && <>\r\n\t\t\t\t\t\t<hr/>\r\n\t\t\t\t\t\t<h2>Les autres participants</h2>\r\n\t\t\t\t\t\t<table className=\"table\">\r\n\t\t\t\t\t\t\t<tbody>\r\n\t\t\t\t\t\t\t\t{Object.entries(autres).map(([name, films]) => <tr key={name}>\r\n\t\t\t\t\t\t\t\t\t<td>{name}</td>\r\n\t\t\t\t\t\t\t\t\t<td>{films.length} film{films.length > 1 && 's'}</td>\r\n\t\t\t\t\t\t\t\t</tr>)}\r\n\t\t\t\t\t\t\t</tbody>\r\n\t\t\t\t\t\t</table>\r\n\t\t\t\t\t</>}\r\n\t\t\t\t</>\r\n\t\t}\r\n\t</>\r\n}\r\n\r\nconst App = props => {\r\n\treturn <div className=\"container\">\r\n\t\t<Content/>\r\n\t</div>\r\n}\r\n\r\nexport default App","const reportWebVitals = onPerfEntry => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport \"bootstrap-icons/font/bootstrap-icons.css\";\nimport './index.css';\nimport App from './App.js'\nimport reportWebVitals from './reportWebVitals';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App/>\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}