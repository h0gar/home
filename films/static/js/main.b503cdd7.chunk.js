(this.webpackJsonptirage_sort=this.webpackJsonptirage_sort||[]).push([[0],{15:function(e,n,t){},16:function(e,n){function t(e){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}t.keys=function(){return[]},t.resolve=t,e.exports=t,t.id=16},18:function(e,n,t){"use strict";t.r(n);var r=t(1),c=t.n(r),a=t(9),s=t.n(a),i=(t(15),t(7)),o=t(3),u=t(10),l=t(2),j=t(8),b=t.n(j),d=t(0);function O(e){for(var n=e.toLowerCase().split(" "),t=0;t<n.length;t++)n[t]=n[t].charAt(0).toUpperCase()+n[t].substring(1);return n.join(" ")}var m=function(e){var n=c.a.useState(""),t=Object(l.a)(n,2),r=t[0],a=t[1],s=c.a.useState({}),i=Object(l.a)(s,2),o=i[0],u=i[1];return Object(d.jsxs)("form",{onSubmit:function(n){n.preventDefault(),r.match(/^[A-z\xc0-\xfa]+$/)?e.onValid(r):u({name:"Choisir un nom avec des lettres uniquement."})},children:[Object(d.jsx)("div",{children:Object(d.jsx)("input",{type:"text",name:"name",value:r,onChange:function(e){a(e.target.value)},className:o.name?"error":""})}),o.name&&Object(d.jsx)("p",{className:"error-msg",children:o.name}),Object(d.jsx)("div",{children:Object(d.jsx)("button",{type:"submit",children:"Valider"})})]})},h=function(e){var n=c.a.useState(""),t=Object(l.a)(n,2),r=t[0],a=t[1],s=c.a.useState([]),i=Object(l.a)(s,2),o=i[0],j=i[1],b=c.a.useState({}),m=Object(l.a)(b,2),h=m[0],f=m[1];return Object(d.jsxs)("form",{onSubmit:function(n){n.preventDefault();var t={};0===r.length&&(t.name="Faut choisir le nom d'un film !"),0===o.length&&(t.platforms="Faut choisir au moins une plateforme !"),f(t),0===Object.keys(t).length&&(e.onAjouter({name:O(r),platforms:o}),a(""),j([]))},children:[Object(d.jsx)("div",{children:Object(d.jsx)("input",{type:"text",value:r,onChange:function(e){a(e.target.value)},className:h.name?"error":""})}),h.name&&Object(d.jsx)("p",{className:"error-msg",children:h.name}),Object(d.jsx)("div",{children:Object(d.jsxs)("select",{multiple:!0,value:o,onChange:function(e){var n=Object(u.a)(e.target.selectedOptions).map((function(e){return e.value}));j(n)},className:h.platforms?"error":"",children:[Object(d.jsx)("option",{children:"Netflix"}),Object(d.jsx)("option",{children:"Amazon"}),Object(d.jsx)("option",{children:"Disney"}),Object(d.jsx)("option",{children:"OCS"}),Object(d.jsx)("option",{children:"Salto"}),Object(d.jsx)("option",{children:"Canal+"}),Object(d.jsx)("option",{children:"Apple TV"})]})}),h.platforms&&Object(d.jsx)("p",{className:"error-msg",children:h.platforms}),Object(d.jsx)("button",{type:"submit",children:"ajouter"})]})},f=function(e){var n=c.a.useState(!1),t=Object(l.a)(n,2),r=t[0],a=t[1],s=c.a.useState(""),i=Object(l.a)(s,2),o=i[0],u=i[1],j=c.a.useState({}),b=Object(l.a)(j,2),O=b[0],m=b[1],h=c.a.useState(!1),f=Object(l.a)(h,2),v=f[0],p=f[1];if(r){return v?Object(d.jsx)(d.Fragment,{children:"Chargement..."}):Object(d.jsxs)("form",{onSubmit:function(n){n.preventDefault(),p(!0),e.onRejoindre(o).catch((function(e){p(!1),m({name:"Impossible de rejoindre ce salon"})}))},children:[Object(d.jsx)("div",{children:Object(d.jsx)("input",{type:"text",value:o,onChange:function(e){u(e.target.value)},className:O.name?"error":""})}),O.name&&Object(d.jsx)("p",{className:"error-msg",children:O.name}),Object(d.jsx)("button",{type:"submit",children:"confirmer"})]})}return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsx)("button",{type:"button",onClick:e.onCreer,children:"cr\xe9er"}),Object(d.jsx)("button",{type:"button",onClick:function(){return a(!0)},children:"rejoindre"})]})},v=function(e){var n=c.a.useState(null),t=Object(l.a)(n,2),r=t[0],a=t[1],s=c.a.useState(null),u=Object(l.a)(s,2),j=u[0],O=u[1],v=c.a.useState([]),p=Object(l.a)(v,2),x=p[0],g=p[1],y=c.a.useState({}),S=Object(l.a)(y,2),C=S[0],N=S[1],k=c.a.useState(null),w=Object(l.a)(k,2),F=w[0],A=w[1],D=c.a.useRef(),M=c.a.useRef();M.current=r;var R=c.a.useRef();R.current=x;var L=c.a.useRef();if(L.current=C,F)return Object(d.jsx)(d.Fragment,{children:Object(d.jsxs)("div",{className:"countdown",children:[Object(d.jsx)("div",{className:"num5",children:"5"}),Object(d.jsx)("div",{className:"num4",children:"4"}),Object(d.jsx)("div",{className:"num3",children:"3"}),Object(d.jsx)("div",{className:"num2",children:"2"}),Object(d.jsx)("div",{className:"num1",children:"1"}),Object(d.jsxs)("div",{className:"num0",children:[Object(d.jsx)("h1",{children:F.name}),F.platforms.join(", ")]})]})});if(null===r)return Object(d.jsx)(m,{onValid:function(e){a(e)}});var T=function(e,n){D.current.connections[n][0].send({type:"sync",autres:e})},V=function(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;for(var t in D.current.connections)t!=="tirage-membre-"+n&&T(e,t)},E=function(e){A(e)},I=(null===j||void 0===j?void 0:j.created)&&3===x.length;if(I)for(var P=0,U=Object.values(L.current);P<U.length;P++){if(U[P].length<3){I=!1;break}}return Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{children:["Salut ",r]}),j?Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("div",{children:["Vous avez ",j.created?"cr\xe9\xe9":"rejoint"," le salon : ",j.code,Object(d.jsx)("br",{}),Object(d.jsx)("span",{className:"link",onClick:function(){D.current.destroy(),O(null),g([]),N({})},children:"Quitter"}),Object(d.jsx)("br",{}),I&&Object(d.jsx)("span",{className:"link",onClick:function(){var e,n=Object.values(L.current),t=n.length>0?n.reduce((function(e,n){var t,r=null!==e&&void 0!==e?e:[],c=Object(i.a)(n.films);try{for(c.s();!(t=c.n()).done;){var a=t.value;r.push(a)}}catch(s){c.e(s)}finally{c.f()}return r})):[],r=Object(i.a)(x);try{for(r.s();!(e=r.n()).done;){var c=e.value;t.push(c)}}catch(o){r.e(o)}finally{r.f()}var a=t[Math.floor(Math.random()*t.length)];for(var s in D.current.connections){D.current.connections[s][0].send({type:"winner",winner:a})}E(a)},children:"Tirer au sort"})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("b",{children:"Mes films"}),Object(d.jsx)("ul",{children:x.map((function(e,n){return Object(d.jsxs)("li",{children:[e.name,Object(d.jsx)("br",{}),e.platforms.join(", "),Object(d.jsx)("br",{}),Object(d.jsx)("span",{className:"link",onClick:function(){return function(e){var n=x.slice();n.splice(e,1),g(n),j.created?V(Object.assign({},L.current,Object(o.a)({},r,n))):Object.values(D.current.connections)[0][0].send({type:"remove",index:e})}(n)},children:"Supprimer"})]},e.name)}))}),x.length<3&&Object(d.jsx)(h,{onAjouter:function(e){var n=x.slice();n.push(e),g(n),j.created?V(Object.assign({},L.current,Object(o.a)({},r,n))):Object.values(D.current.connections)[0][0].send({type:"add",film:e})}})]}),Object(d.jsxs)("div",{children:[Object(d.jsx)("b",{children:"Les autres"}),Object(d.jsx)("ul",{children:Object.entries(C).map((function(e){var n=Object(l.a)(e,2),t=n[0],r=n[1];return Object(d.jsxs)("li",{children:[t," : ",r.length," films"]},t)}))})]})]}):Object(d.jsx)(f,{onCreer:function(){var e=function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:5,n="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",r=t.length,c=0;c<e;c++)n+=t.charAt(Math.floor(Math.random()*r));return n}(),n=new b.a("tirage-salon-"+e,{});D.current=n,n.on("connection",(function(e){var n;e.on("data",(function(e){if("hello"===e.type){n=e.name,T(Object.assign({},L.current,Object(o.a)({},M.current,R.current)),"tirage-membre-"+n);var t=Object.assign({},L.current,Object(o.a)({},n,[]));N(t)}else if("add"===e.type){var r=Object.assign({},L.current);r[n]=r[n].slice(),r[n].push(e.film),V(Object.assign({},r,Object(o.a)({},M.current,R.current)),n),N(r)}else if("remove"===e.type){var c=Object.assign({},L.current);c[n]=c[n].slice(),c[n].splice(e.index,1),V(Object.assign({},c,Object(o.a)({},M.current,R.current)),n),N(c)}})),e.on("close",(function(){var e=Object.assign({},L.current);delete e[n],V(Object.assign({},e,Object(o.a)({},M.current,R.current)),n),N(e)}))})),O({code:e,created:!0})},onRejoindre:function(e){return new Promise((function(n,t){var c=new b.a("tirage-membre-"+r,{});D.current=c,c.on("error",(function(e){t(e)})),c.on("open",(function(){var a=c.connect("tirage-salon-"+e,{});a.on("open",(function(){a.send({type:"hello",name:r}),O({code:e,created:!1}),g([]),N({}),n()})),a.on("data",(function(e){"sync"===e.type?(delete e.autres[r],N(e.autres)):"winner"===e.type&&E(e.winner)})),a.on("error",(function(e){t(e)})),a.on("close",(function(){O(null)}))}))}))}})]})},p=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,19)).then((function(n){var t=n.getCLS,r=n.getFID,c=n.getFCP,a=n.getLCP,s=n.getTTFB;t(e),r(e),c(e),a(e),s(e)}))};s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(v,{})}),document.getElementById("root")),p()}},[[18,1,2]]]);
//# sourceMappingURL=main.b503cdd7.chunk.js.map